--
-- Script was generated by Devart dbForge Studio 2020 for MySQL, Version 9.0.338.0
-- Product home page: http://www.devart.com/dbforge/mysql/studio
-- Script date 08/08/2023 10:08:27 CH
-- Server version: 8.0.31
-- Client version: 4.1
--

-- 
-- Disable foreign keys
-- 
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;

-- 
-- Set SQL mode
-- 
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

-- 
-- Set character set the client will use to send SQL statements to the server
--
SET NAMES 'utf8';

--
-- Set default database
--
USE salad_todo_daily;

--
-- Drop table `note`
--
DROP TABLE IF EXISTS note;

--
-- Drop table `tag`
--
DROP TABLE IF EXISTS tag;

--
-- Drop table `user`
--
DROP TABLE IF EXISTS user;

--
-- Drop table `task`
--
DROP TABLE IF EXISTS task;

--
-- Drop table `project`
--
DROP TABLE IF EXISTS project;

--
-- Drop table `task_daily_history`
--
DROP TABLE IF EXISTS task_daily_history;

--
-- Drop table `task_daily`
--
DROP TABLE IF EXISTS task_daily;

--
-- Set default database
--
USE salad_todo_daily;

--
-- Create table `task_daily`
--
CREATE TABLE task_daily (
  id int NOT NULL AUTO_INCREMENT,
  name varchar(256) NOT NULL,
  description text DEFAULT NULL,
  tagId json DEFAULT NULL,
  startDate timestamp NULL DEFAULT NULL,
  finishDate timestamp NULL DEFAULT NULL,
  priority tinyint DEFAULT 1,
  isDeleted tinyint NOT NULL DEFAULT 0,
  createdAt timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  createdBy int NOT NULL,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 12,
AVG_ROW_LENGTH = 2048,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci;

--
-- Create table `task_daily_history`
--
CREATE TABLE task_daily_history (
  id int NOT NULL AUTO_INCREMENT,
  taskDailyId int NOT NULL,
  completionDate timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 62,
AVG_ROW_LENGTH = 303,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci;

--
-- Create foreign key
--
ALTER TABLE task_daily_history
ADD CONSTRAINT task_daily_history_ibfk_1 FOREIGN KEY (taskDailyId)
REFERENCES task_daily (id);

--
-- Create table `project`
--
CREATE TABLE project (
  id int NOT NULL AUTO_INCREMENT,
  name varchar(256) NOT NULL,
  description text DEFAULT NULL,
  color varchar(20) DEFAULT NULL,
  isDeleted tinyint NOT NULL DEFAULT 0,
  startDate timestamp NULL DEFAULT NULL,
  finishDate timestamp NULL DEFAULT NULL,
  createdAt timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  createdBy int NOT NULL,
  totalTask int DEFAULT 0,
  completedTask int DEFAULT 0,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 10,
AVG_ROW_LENGTH = 2730,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci;

--
-- Create table `task`
--
CREATE TABLE task (
  id int NOT NULL AUTO_INCREMENT,
  name varchar(256) NOT NULL,
  projectId int DEFAULT NULL,
  description text DEFAULT NULL,
  startDate timestamp NULL DEFAULT NULL,
  finishDate timestamp NULL DEFAULT NULL,
  priority tinyint DEFAULT 1,
  status tinyint DEFAULT 0,
  checkList json DEFAULT NULL,
  isDeleted tinyint DEFAULT 0,
  createdAt timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  createdBy int NOT NULL,
  duration int DEFAULT NULL,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 85,
AVG_ROW_LENGTH = 390,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci;

--
-- Create foreign key
--
ALTER TABLE task
ADD CONSTRAINT task_ibfk_1 FOREIGN KEY (projectId)
REFERENCES project (id);

--
-- Create table `user`
--
CREATE TABLE user (
  id int NOT NULL AUTO_INCREMENT,
  name varchar(256) NOT NULL,
  email varchar(256) NOT NULL,
  password varchar(256) NOT NULL,
  avatar varchar(255) DEFAULT NULL,
  telegramId varchar(50) DEFAULT NULL,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 5,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci;

--
-- Create table `tag`
--
CREATE TABLE tag (
  id int NOT NULL AUTO_INCREMENT,
  name varchar(256) NOT NULL,
  color varchar(20) DEFAULT NULL,
  isDeleted tinyint NOT NULL DEFAULT 0,
  createdAt timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  createdBy int NOT NULL,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 7,
AVG_ROW_LENGTH = 3276,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci;

--
-- Create table `note`
--
CREATE TABLE note (
  id int NOT NULL AUTO_INCREMENT,
  title varchar(256) NOT NULL,
  content text DEFAULT NULL,
  isDeleted tinyint NOT NULL DEFAULT 0,
  createdAt timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  createdBy int NOT NULL,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci;

-- 
-- Dumping data for table task_daily
--
INSERT INTO task_daily VALUES
(1, 'Chống đẩy', 'chống đẩy ngày sau nhiều hơn ngày trước\n', '[1]', '2023-07-18 20:59:24', NULL, NULL, 0, '2023-07-29 21:04:55', 2),
(2, 'Check mail', 'Kiểm tra gmail, outlook, ctt, ctsv, https://soict.hust.edu.vn/thong-bao-ve-thuc-tap-doanh-nghiep-ky-2022-3.html', '[]', '2023-07-29 21:05:02', NULL, NULL, 0, '2023-07-29 21:05:27', 2),
(3, 'Đọc sách', NULL, '[2]', '2023-07-29 21:23:06', NULL, 1, 0, '2023-07-29 21:23:15', 2),
(4, 'Lên xà', NULL, '[1]', '2023-07-29 21:31:49', NULL, 1, 0, '2023-07-29 21:41:11', 2),
(5, 'Push code Github', NULL, '[3]', '2023-07-31 14:47:03', NULL, 1, 0, '2023-07-31 14:48:30', 2),
(6, 'Quản lý thu chi', 'á', '[]', '2023-07-31 14:58:28', NULL, NULL, 0, '2023-07-31 15:39:37', 2),
(7, 'Học từ vựng tiếng Anh', NULL, '[]', '2023-07-31 14:58:28', NULL, 1, 0, '2023-07-31 15:40:09', 2),
(8, 'Học từ vựng tiếng Nhật', NULL, '[]', '2023-07-31 14:58:28', NULL, 1, 0, '2023-07-31 15:40:20', 2),
(9, 'Nghiên cứu', NULL, '[]', '2023-08-03 06:18:18', NULL, 1, 0, '2023-08-03 06:18:26', 2),
(10, 'Chống đẩy', 'awef', '[1]', '2023-07-18 20:59:24', NULL, 1, 1, '2023-08-04 12:58:41', 2),
(11, 'test', 'ăefsd', '[1, 2, 3]', '2023-08-05 19:00:32', NULL, 1, 1, '2023-08-05 19:00:50', 2);

-- 
-- Dumping data for table project
--
INSERT INTO project VALUES
(1, 'ằea1f', 'Moo ta\n', NULL, 1, '2023-07-17 12:38:53', NULL, NULL, 2, 0, 0),
(2, 'Project Đồ án 1', 'Project đồ án 1 hoàn thành và báo cáo cho thầy vào kỳ 2022.2', 'red', 0, '2023-07-16 12:50:47', NULL, NULL, 2, 28, 22),
(3, 'Thuyết trình Nhật 8 cuối kỳ', NULL, 'blue', 0, '2023-07-21 11:51:39', NULL, '2023-07-21 11:52:23', 2, 3, 3),
(4, 'Giáo dục nghề nghiệp tỉnh Bắc Kạn', 'Dự án công ty Bách Khoa', '#13C2C2', 0, '2023-07-25 14:13:26', NULL, NULL, 2, 9, 7),
(5, 'tesst', NULL, 'yellow', 1, '2023-07-29 16:31:21', NULL, '2023-07-29 16:32:38', 2, 0, 0),
(6, 'Test ngày kết thúc', NULL, '', 1, '2023-07-29 19:17:28', '2023-08-02 19:18:53', '2023-07-29 19:18:57', 2, 0, 0),
(7, 'App Giáo dục Tuyên Quang', '', '#CC0000', 0, '2023-08-01 13:48:54', NULL, '2023-08-01 13:54:25', 2, 6, 3),
(8, 'test', NULL, NULL, 1, '2023-08-01 20:35:07', NULL, '2023-08-01 20:35:11', 2, 0, 0),
(9, 'S-ERP RnD', NULL, 'purple', 0, '2023-08-02 13:57:02', NULL, '2023-08-02 14:35:14', 2, 1, 0);

-- 
-- Dumping data for table user
--
INSERT INTO user VALUES
(1, 'Nguyen Van A', '3wqjX@example.com', '123456', NULL, NULL),
(2, 'Salad Lê', 'leduchyu10@gmail.com', '123456', NULL, NULL),
(3, 'Người dùng 2', 'test@gmail.com', '654321', NULL, NULL);

-- 
-- Dumping data for table task_daily_history
--
INSERT INTO task_daily_history VALUES
(5, 5, '2023-07-31 14:48:31'),
(6, 1, '2023-07-31 15:04:37'),
(7, 2, '2023-07-31 15:08:00'),
(8, 3, '2023-07-31 15:17:57'),
(9, 6, '2023-07-31 16:04:54'),
(10, 7, '2023-07-31 20:13:28'),
(11, 8, '2023-07-31 20:21:36'),
(12, 4, '2023-07-31 21:45:37'),
(13, 7, '2023-08-01 10:45:42'),
(14, 8, '2023-08-01 11:03:33'),
(15, 5, '2023-08-01 11:04:25'),
(16, 3, '2023-08-01 13:48:56'),
(17, 2, '2023-08-01 13:56:09'),
(18, 4, '2023-08-01 20:45:23'),
(19, 6, '2023-08-01 22:13:34'),
(20, 2, '2023-08-02 16:14:36'),
(21, 3, '2023-08-02 18:27:46'),
(22, 4, '2023-08-02 18:54:40'),
(23, 5, '2023-08-02 20:31:20'),
(24, 6, '2023-08-02 20:58:19'),
(25, 7, '2023-08-02 21:53:39'),
(26, 8, '2023-08-02 21:58:48'),
(27, 1, '2023-08-02 21:58:49'),
(28, 9, '2023-08-03 09:15:45'),
(29, 3, '2023-08-03 15:00:32'),
(30, 2, '2023-08-03 16:51:13'),
(31, 7, '2023-08-04 06:52:26'),
(32, 8, '2023-08-04 07:02:18'),
(33, 3, '2023-08-04 13:53:02'),
(34, 2, '2023-08-04 13:53:19'),
(35, 1, '2023-08-05 20:10:20'),
(36, 2, '2023-08-05 20:47:29'),
(37, 5, '2023-08-05 20:47:33'),
(38, 6, '2023-08-05 21:06:57'),
(39, 7, '2023-08-05 21:53:11'),
(40, 8, '2023-08-05 22:13:12'),
(41, 3, '2023-08-05 22:13:15'),
(42, 1, '2023-08-06 21:16:11'),
(43, 2, '2023-08-06 21:40:17'),
(44, 4, '2023-08-06 21:40:19'),
(47, 5, '2023-08-06 21:54:35'),
(48, 6, '2023-08-06 22:42:44'),
(49, 7, '2023-08-06 23:00:13'),
(50, 3, '2023-08-06 23:00:17'),
(51, 8, '2023-08-06 23:01:23'),
(52, 9, '2023-08-06 23:05:16'),
(53, 1, '2023-08-07 20:04:13'),
(54, 2, '2023-08-07 20:57:27'),
(55, 7, '2023-08-07 21:00:32'),
(56, 8, '2023-08-07 21:02:40'),
(57, 9, '2023-08-07 21:05:02'),
(58, 6, '2023-08-07 22:31:59'),
(59, 5, '2023-08-07 22:43:10'),
(60, 3, '2023-08-07 22:44:33'),
(61, 2, '2023-08-08 22:03:35');

-- 
-- Dumping data for table task
--
INSERT INTO task VALUES
(13, 'Thêm custom thanh scroll cho danh sách các công việc', 2, NULL, '2023-07-18 14:41:14', '2023-07-18 23:59:59', 2, 2, '[{"checked": true, "content": "Tham khảo W3 school"}, {"checked": true, "content": "Làm giống scroll của Trello"}]', 0, '2023-07-18 14:42:15', 2, NULL),
(14, 'Thêm trường tổng số công việc, số công việc còn lại và triggle tự động cập nhật', 2, NULL, '2023-07-14 00:00:01', '2023-07-20 23:59:59', 2, 2, '[{"checked": true, "content": "Thêm 2 trường số công việc"}, {"checked": true, "content": "Thêm triggle khi Tạo công việc"}, {"checked": true, "content": "Thêm triggle khi Xóa công việc"}, {"checked": true, "content": "Thêm triggle khi cập nhật công việc"}]', 0, '2023-07-18 14:54:43', 2, NULL),
(15, 'Thêm trường duration cho form tạo mới công việc', 2, NULL, '2023-07-16 00:00:00', '2023-07-18 23:59:59', 2, 2, '[{"checked": true, "content": "Tham khảo NG zorro"}]', 0, '2023-07-18 14:55:21', 2, NULL),
(16, 'Thêm chức năng sửa công việc', 2, '', '2023-07-16 20:45:20', '2023-07-18 23:59:59', 3, 2, '[{"checked": true, "content": "Tham khảo code tạo công việc"}, {"checked": true, "content": "Thêm lại chức năng sửa"}]', 0, '2023-07-18 14:57:35', 2, 15),
(17, 'Thêm review màu khi tạo project', 2, NULL, '2023-07-15 00:00:00', '2023-07-29 23:59:59', 1, 2, '[]', 0, '2023-07-18 22:54:16', 2, 15),
(19, 'Thêm hiển thị thời gian thực hiện còn lại của từng nhóm công việc', 2, NULL, '2023-07-16 00:00:01', '2023-07-20 23:59:59', 2, 2, '[{"checked": true, "content": "Lấy được thời gian"}, {"checked": true, "content": "Chuyển thời gian thành text"}]', 0, '2023-07-19 16:18:15', 2, 30),
(20, 'Vấn đề về thời gian giữa FE và BE', 2, NULL, '2023-07-21 00:00:00', '2023-07-21 23:59:59', 2, 2, '[]', 0, '2023-07-19 16:35:02', 2, 15),
(21, 'Cập nhật trạng thái thói quen hàng ngày', 2, NULL, '2023-07-19 00:00:00', '2023-07-21 23:59:59', 2, 2, '[{"checked": true, "content": "Kiểm tra bảng history"}, {"checked": true, "content": "Viết api thêm history"}, {"checked": true, "content": "Kiểm tra luồng thêm history"}, {"checked": true, "content": "Tạo hàm thêm history FE"}, {"checked": true, "content": "Viết api xóa history"}, {"checked": true, "content": "Tạo hàm xóa history FE"}, {"checked": true, "content": "Kiểm tra luồng xóa"}]', 0, '2023-07-20 16:47:56', 2, 45),
(24, 'Edit check list', 2, NULL, '2023-07-22 00:00:00', NULL, 1, 0, '[]', 0, '2023-07-21 09:06:07', 2, 30),
(25, 'Xóa một task', 2, NULL, '2023-07-21 00:00:00', '2023-07-21 23:59:59', 2, 2, '[{"checked": true, "content": "Viết hàm xóa 1 task (Cập nhật trường isDeleted = 1)"}, {"checked": true, "content": "Kiểm tra luồng xóa"}]', 0, '2023-07-21 09:44:45', 2, NULL),
(27, 'Lỗi thêm check List ngay sau khi vừa tạo công việc', 2, NULL, '2023-07-21 00:00:00', '2023-07-21 23:59:59', 2, 2, '[{"checked": true, "content": "Đặt debugger xem value của form khi vừa sửa công việc"}]', 0, '2023-07-21 09:59:47', 2, 15),
(28, 'Hiển thị đồng hồ đếm ngược', 2, NULL, '2023-07-21 00:00:00', NULL, 1, 0, '[{"checked": false, "content": "test"}]', 0, '2023-07-21 10:00:47', 2, NULL),
(29, 'Xóa form sau khi tạo công việc thành công', 2, NULL, '2023-07-21 00:00:00', '2023-07-21 23:59:59', 2, 2, '[]', 0, '2023-07-21 10:01:01', 2, 15),
(37, 'Thêm xác nhận khi xóa task', 2, NULL, '2023-07-21 00:00:00', '2023-07-21 23:59:59', 2, 2, '[{"checked": true, "content": "Tìm ng zorro"}, {"checked": true, "content": "Viết hàm xác nhận"}]', 0, '2023-07-21 10:18:04', 2, 15),
(38, 'test', NULL, NULL, '2023-07-21 00:00:00', NULL, 2, 0, '[]', 1, '2023-07-21 10:26:11', 2, NULL),
(39, 'test', NULL, NULL, '2023-07-21 00:00:00', '2023-07-21 23:59:59', 2, 2, '[]', 1, '2023-07-21 10:26:39', 2, NULL),
(40, 'Thêm thời gian thực hiện vào task item ', 2, NULL, '2023-07-21 00:00:00', '2023-07-21 23:59:59', 2, 2, '[]', 0, '2023-07-21 10:55:56', 2, 15),
(41, 'Chuyển dùng hàm trong html thành transform data', 2, NULL, '2023-07-21 00:00:00', '2023-07-26 23:59:59', 2, 2, '[]', 0, '2023-07-21 11:00:25', 2, 15),
(42, 'test', NULL, NULL, '2023-07-21 00:00:00', NULL, 2, 0, '[]', 1, '2023-07-21 11:49:40', 2, NULL),
(43, 'tsst', NULL, NULL, '2023-07-21 00:00:00', NULL, 2, 0, '[]', 1, '2023-07-21 11:51:45', 2, NULL),
(44, 'Tạo script Nhật 8', 3, NULL, '2023-07-25 00:00:00', '2023-07-25 23:59:59', 3, 2, '[{"checked": true, "content": "Làm script nhật 8 lợi ích AI"}, {"checked": true, "content": "Dịch script sang tiếng nhật"}, {"checked": true, "content": "Tìm lại script giới thiệu nhóm"}]', 0, '2023-07-21 11:53:02', 2, 30),
(45, 'Hoàn thành slide thuyết trình Nhật 8', 3, 'Link docs: https://docs.google.com/document/d/1qtYnw-5pcZr695kcYtaxjVqL_bM_yWT4Cgfi9Z4oudc/edit\nLink slide: https://docs.google.com/presentation/d/1US90OFRdJTq-PtO3bDrVudbO1cDz1ir9CJiwqT_u7Vs/edit#slide=id.gd55b463498_0_5', '2023-07-25 00:00:00', '2023-07-25 23:59:59', 3, 2, '[{"checked": true, "content": "Tạo slide bìa"}, {"checked": true, "content": "Tạo slide giới thiệu nhóm"}, {"checked": true, "content": "Tạo slide giới thiệu nội dung"}, {"checked": true, "content": "Tạo Slide lợi ích có 3 cột"}, {"checked": true, "content": "Tìm hình ảnh thám hiểm vùng có độc"}, {"checked": true, "content": "Tìm hình ảnh AI năng suất"}, {"checked": true, "content": "Tìm hình ảnh AI trong y tế"}, {"checked": true, "content": "Hoàn thiện làm đẹp, animation"}]', 0, '2023-07-25 12:56:18', 2, 30),
(46, 'Tạo anki Học thuộc script thuyết trình cuối kỳ nhật 8', 3, 'https://docs.google.com/document/d/14uHKH8eIe-tqwwvSES_0Sw4SX5EN8XjINWb8tbIzKIc/edit', '2023-07-25 00:00:00', '2023-07-31 23:59:59', 3, 2, '[{"checked": true, "content": "Tạo Bộ thẻ nhật 8"}, {"checked": true, "content": "Tạo các từ vựng trong script nhật 8"}, {"checked": true, "content": "Học thuộc lòng các từ vựng trong script nhật 8"}, {"checked": true, "content": "Tạo các câu hỏi cloze script nhật 8"}, {"checked": true, "content": "Học thuộc lòng nội dung thứ tự script nhật 8"}]', 0, '2023-07-25 12:59:45', 2, 15),
(47, 'Fix bug Import bản ghi con bị hiện full quyền', 4, NULL, '2023-07-25 00:00:00', '2023-07-26 23:59:59', 3, 2, '[{"checked": true, "content": "Gửi Request cho Cường"}, {"checked": true, "content": "Nhận thông báo của Cường và kiểm tra lại"}]', 0, '2023-07-25 14:15:14', 2, 45),
(48, 'Kiểm tra Trang web portal tại sao trắng xóa', 4, 'http://dev.bkholding.vn:2004/home.htm\n=> Tại sao build thường thì ra vendor.js còn build-prod thì lại không ra -> đây chính là nguyên nhân sai\n', '2023-07-25 00:00:00', '2023-07-25 23:59:59', 2, 2, '[{"checked": true, "content": "Kiểm tra F12 trang web"}, {"checked": true, "content": "Thử deploy lại"}]', 0, '2023-07-25 14:17:57', 2, 15),
(49, 'RnD cách tự động xóa cache', 9, 'Code chuẩn project test', '2023-07-25 00:00:00', NULL, 3, 1, '[{"checked": true, "content": "Xóa đi các code trong project cho đỡ nặng"}, {"checked": true, "content": "Sửa lỗi brower..."}, {"checked": false, "content": "Check phiên bản mới"}]', 0, '2023-07-25 15:15:28', 2, 60),
(50, 'Tạo 4 ảnh map marker cho anh Lân', NULL, NULL, '2023-07-25 00:00:00', '2023-07-25 23:59:59', 2, 2, '[]', 0, '2023-07-25 15:50:43', 2, 15),
(51, 'Check lỗi Không xóa được cha dù không có con', 4, 'Không tìm thấy lỗi', '2023-07-26 00:00:00', '2023-07-26 23:59:59', 2, 2, '[{"checked": false, "content": "Kiểm tra màn lớp"}, {"checked": false, "content": "Kiểm tra màn phòng ban"}, {"checked": false, "content": "Kiểm tra màn ngành"}, {"checked": false, "content": "Kiểm tra màn cơ sở giáo dục"}]', 0, '2023-07-26 08:17:14', 2, 45),
(52, 'Làm báo cáo đồ án', 2, NULL, '2023-07-26 00:00:00', '2023-07-30 23:59:59', 2, 2, '[]', 0, '2023-07-26 09:26:02', 2, NULL),
(53, 'Ôn tập Trí tuệ nhân tạo', NULL, NULL, '2023-07-26 00:00:00', '2023-07-29 23:59:59', 2, 2, '[]', 0, '2023-07-26 09:27:40', 2, NULL),
(54, 'Tạo công việc 2 lần liên tiếp là bug', 2, 'Bug vì isDeleted không được truyền lên sau khi reset form mà database yêu cầu not null', '2023-07-26 00:00:00', '2023-07-27 23:59:59', 2, 2, '[]', 0, '2023-07-26 09:28:27', 2, 15),
(55, 'Ôn  tập lịch sử đảng', NULL, NULL, '2023-07-26 00:00:00', '2023-07-29 23:59:59', 2, 2, '[]', 0, '2023-07-26 09:30:36', 2, NULL),
(56, 'Gửi thông báo đến telegram', 2, NULL, '2023-07-26 00:00:00', '2023-07-26 23:59:59', 2, 2, '[]', 0, '2023-07-26 09:30:49', 2, 30),
(57, 'Thêm avatar và chức năng đăng xuất', 2, NULL, '2023-07-26 00:00:00', '2023-07-26 23:59:59', 2, 1, '[]', 0, '2023-07-26 09:32:01', 2, 30),
(58, 'Thông báo bản ghi nào xóa được rồi bản ghi nào chưa', 4, 'Chờ BE', '2023-07-26 00:00:00', NULL, 2, 0, '[{"checked": false, "content": "Màn lớp học viên"}, {"checked": false, "content": "Màn ngành"}, {"checked": false, "content": "Màn phòng ban"}, {"checked": false, "content": "Màn csgd"}]', 0, '2023-07-26 14:27:45', 2, 30),
(59, 'test', NULL, NULL, '2023-07-26 00:00:00', NULL, 2, 0, '[]', 1, '2023-07-26 21:32:15', 2, NULL),
(60, 'Thêm chức năng sửa vào context menu', 2, NULL, '2023-07-26 00:00:00', '2023-07-26 23:59:59', 2, 2, '[]', 0, '2023-07-26 21:34:29', 2, 15),
(61, '3 màn danh mục ngành nghề cho cuộn cả trang', 4, NULL, '2023-07-27 00:00:00', '2023-07-27 23:59:59', 2, 2, '[]', 0, '2023-07-27 10:07:17', 2, 30),
(63, 'Không bắt nhập tỉnh thành quận huyện màn Giáo viên', 4, NULL, '2023-07-27 00:00:00', '2023-07-27 23:59:59', 2, 2, '[]', 0, '2023-07-27 11:23:30', 2, 15),
(64, 'Chuyển giữa quản trị hệ thống và trang chủ bị lỗi dashboard', 4, NULL, '2023-07-27 00:00:00', NULL, 2, 0, '[{"checked": false, "content": "Nhờ Dũng check"}]', 0, '2023-07-27 11:23:56', 2, 30),
(65, 'Lấy list màn giáo viên bị lỗi', 4, NULL, '2023-07-27 00:00:00', '2023-07-27 23:59:59', 2, 2, '[{"checked": true, "content": "Fix bug lấy department"}, {"checked": true, "content": "Fixbug lấy training industry"}]', 0, '2023-07-27 11:30:20', 2, NULL),
(68, 'Prod không import export dược ', 4, NULL, '2023-07-27 00:00:00', '2023-07-27 23:59:59', 2, 2, '[{"checked": true, "content": "Báo anh loki deploy lại"}]', 0, '2023-07-27 11:43:41', 2, 15),
(69, 'rwe', 5, NULL, '2023-07-29 00:00:00', NULL, 2, 0, '[]', 1, '2023-07-29 16:32:50', 2, NULL),
(70, 'Thêm ngày kết thúc khi tạo và sửa Project', 2, NULL, '2023-07-29 00:00:00', '2023-07-29 23:59:59', 2, 2, '[{"checked": true, "content": "Thêm ngày kết thúc"}, {"checked": true, "content": "Chỉ hiển thị những project khả dụng trong select list khi tạo task"}]', 0, '2023-07-29 18:29:01', 2, 15),
(71, 'Công việc test', NULL, NULL, '2023-07-31 00:00:00', NULL, 2, 0, '[]', 0, '2023-07-31 08:27:33', 3, NULL),
(72, 'Sửa lỗi đăng nhập xong bị lưu token cũ', 2, NULL, '2023-07-31 00:00:00', '2023-07-31 23:59:59', 2, 2, '[]', 0, '2023-07-31 14:41:54', 2, 15),
(73, 'Thêm quản lý tag', 2, NULL, '2023-07-31 00:00:00', '2023-07-31 23:59:59', 2, 2, '[{"checked": true, "content": "Thêm màn hình view"}, {"checked": true, "content": "Thêm chức năng tạo nhã"}, {"checked": true, "content": "Thêm chức năng sửa nhãn"}, {"checked": true, "content": "Thêm chức năng xóa nhã"}]', 0, '2023-07-31 14:49:44', 2, 15),
(74, 'Thêm trang quản lý thói quen hàng này', 2, NULL, '2023-07-31 00:00:00', '2023-08-05 23:59:59', 2, 2, '[{"checked": true, "content": "Thêm bảng quản trị"}, {"checked": true, "content": "Thêm nút thêm"}, {"checked": true, "content": "Thêm chức năng sửa"}, {"checked": true, "content": "Thêm chức năng xóa"}]', 0, '2023-07-31 21:34:34', 2, 30),
(75, 'Bổ sung trường Số GPKD, Số Giấy phép hoạt động cho node', 7, '‼️Bổ sung trường Số GPKD, Số Giấy phép hoạt động cho node với type = ''language-center'', ''vocational-center'', ''informatic-center'' trên admin', '2023-08-01 00:00:00', '2023-08-01 23:59:59', 2, 2, '[{"checked": true, "content": "Màn Trung tâm ngoại ngữ (Language center)"}, {"checked": true, "content": "Màn trung tâm dạy nghề (vocational center)"}, {"checked": true, "content": "Màn Trung tâm tin học (informatic center)"}]', 0, '2023-08-01 13:55:02', 2, 30),
(76, 'Lập trình bổ sung các trường dữ liệu lưu trữ thông tin Tỉnh thành, Quận huyện user trên admin', 7, '‼️Lập trình bổ sung các trường dữ liệu lưu trữ thông tin Tỉnh thành, Quận huyện user trên admin\nLưu là bị reset 2 trường sau\n=> Không cho reset\n=> Chỉ reset khi đổi data hoặc x đi', '2023-08-01 00:00:00', '2023-08-02 23:59:59', 2, 2, '[]', 0, '2023-08-01 13:55:34', 2, 30),
(77, 'Lập trình UI BCTK user theo đơn vị hành chính', 7, NULL, '2023-08-01 00:00:00', NULL, 2, 1, '[{"checked": false, "content": "Lập trình giao diện"}, {"checked": false, "content": "Tìm hiểu repo Backend"}, {"checked": false, "content": "Tạo hàm trong BE"}, {"checked": false, "content": "Ghép vào FE"}, {"checked": false, "content": "Test"}]', 0, '2023-08-01 13:56:03', 2, 60),
(78, 'Sửa mô tả thành edit text và thêm tệp đính kèm vào tất cả các màn', 7, NULL, '2023-08-01 00:00:00', NULL, 2, 0, '[]', 0, '2023-08-01 14:20:18', 2, 30),
(79, 'Sửa lại code import export excel của 3 màn mới thêm trường', 7, NULL, '2023-08-03 00:00:00', '2023-08-03 23:59:59', 2, 2, '[{"checked": true, "content": "Copy 1 hàm mới"}, {"checked": true, "content": "Đổi tên hàm cũ"}, {"checked": true, "content": "Sửa lại hàm mới"}, {"checked": true, "content": "Test"}, {"checked": true, "content": "Sửa lại template excel"}, {"checked": true, "content": "Copy import"}, {"checked": true, "content": "Đổi tên import cũ"}, {"checked": true, "content": "Sửa lại import mới"}, {"checked": true, "content": "Test import"}]', 0, '2023-08-03 08:35:24', 2, 30),
(80, 'Thêm trang thống kê công việc hàng ngày', 2, NULL, '2023-08-04 00:00:00', NULL, 2, 0, '[]', 0, '2023-08-04 06:33:24', 2, 60),
(81, 'Không hiển thị những thói quen đã hoàn thành', 2, NULL, '2023-08-06 00:00:00', NULL, 2, 1, '[]', 0, '2023-08-06 21:17:02', 2, 15),
(82, 'Ôn thi Kiến trúc máy tính', NULL, NULL, '2023-08-07 00:00:00', NULL, 3, 1, '[{"checked": true, "content": "Ôn tập slide Chương 7: Hệ thống vào-ra"}, {"checked": true, "content": "Làm đề Cuối kỳ K60 trên JAV code"}, {"checked": true, "content": "Đọc Chương 2"}, {"checked": false, "content": "Làm đề cuối kỳ K65"}]', 0, '2023-08-07 07:28:06', 2, NULL),
(83, 'Thêm ngày thực hiện thói quen', 2, NULL, '2023-08-07 00:00:00', NULL, 2, 0, '[]', 0, '2023-08-07 20:37:01', 2, NULL),
(84, 'Tìm hiểu project BE', 7, NULL, '2023-08-08 00:00:00', NULL, 2, 1, '[{"checked": false, "content": "Tìm Model của User"}]', 0, '2023-08-08 14:33:06', 2, NULL);

-- 
-- Dumping data for table tag
--
INSERT INTO tag VALUES
(1, 'Sức khỏe', 'green', 0, '2023-07-18 08:16:52', 2),
(2, 'Trí não', 'blue', 0, '2023-07-18 08:16:52', 2),
(3, 'Công việc', 'red', 0, '2023-07-18 08:16:52', 2),
(5, 'Ngoại ngữ', 'yellow', 0, '2023-07-31 21:29:48', 2),
(6, 'test', 'grey', 1, '2023-07-31 21:31:45', 2);

-- 
-- Dumping data for table note
--
INSERT INTO note VALUES
(1, 'Làm bài JLPT', 'nhớ làm bài đừng quên', 0, '2023-07-18 08:43:14', 2);

--
-- Set default database
--
USE salad_todo_daily;

--
-- Drop trigger `tg_update_task`
--
DROP TRIGGER IF EXISTS tg_update_task;

--
-- Drop trigger `tg_update_totalTask`
--
DROP TRIGGER IF EXISTS tg_update_totalTask;

--
-- Drop trigger `update_task_tg_update_completedTask`
--
DROP TRIGGER IF EXISTS update_task_tg_update_completedTask;

--
-- Drop trigger `delete_task_tg_update_totalTask`
--
DROP TRIGGER IF EXISTS delete_task_tg_update_totalTask;

--
-- Set default database
--
USE salad_todo_daily;

DELIMITER $$

--
-- Create trigger `delete_task_tg_update_totalTask`
--
CREATE
DEFINER = 'root'@'localhost'
TRIGGER delete_task_tg_update_totalTask
AFTER UPDATE
ON task
FOR EACH ROW
BEGIN
  IF OLD.isDeleted = 0
    AND NEW.isDeleted = 1 THEN
    UPDATE project
    SET totalTask = totalTask - 1
    WHERE id = NEW.projectId;
  END IF;
END
$$

--
-- Create trigger `update_task_tg_update_completedTask`
--
CREATE
DEFINER = 'root'@'localhost'
TRIGGER update_task_tg_update_completedTask
AFTER UPDATE
ON task
FOR EACH ROW
FOLLOWS delete_task_tg_update_totalTask
BEGIN
  IF OLD.projectId != NEW.projectId THEN
    UPDATE project
    SET totalTask = (SELECT
            COUNT(*)
          FROM task t
          WHERE t.projectId = OLD.projectId
          AND t.createdBy = OLD.createdBy
          AND t.isDeleted = 0),
        completedTask = (SELECT
            COUNT(*)
          FROM task t
          WHERE t.projectId = OLD.projectId
          AND t.status = 2
          AND t.createdBy = OLD.createdBy
          AND t.isDeleted = 0)
    WHERE id = OLD.projectId;
  END IF;
  UPDATE project
  SET totalTask = (SELECT
          COUNT(*)
        FROM task t
        WHERE t.projectId = NEW.projectId
        AND t.createdBy = NEW.createdBy
        AND t.isDeleted = 0),
      completedTask = (SELECT
          COUNT(*)
        FROM task t
        WHERE t.projectId = NEW.projectId
        AND t.status = 2
        AND t.createdBy = NEW.createdBy
        AND t.isDeleted = 0)
  WHERE id = NEW.projectId;
END
$$

--
-- Create trigger `tg_update_totalTask`
--
CREATE
DEFINER = 'root'@'localhost'
TRIGGER tg_update_totalTask
AFTER INSERT
ON task
FOR EACH ROW
BEGIN
  IF NEW.projectId IS NOT NULL THEN
    UPDATE project
    SET totalTask = totalTask + 1
    WHERE id = NEW.projectId;
  END IF;
END
$$

--
-- Create trigger `tg_update_task`
--
CREATE
DEFINER = 'root'@'localhost'
TRIGGER tg_update_task
BEFORE UPDATE
ON task
FOR EACH ROW
BEGIN
  IF NEW.status = 2
    AND NEW.status != OLD.status THEN
    SET NEW.finishDate = TIMESTAMP(DATE(NOW()), TIME('23:59:59'));
  END IF;
END
$$

DELIMITER ;

-- 
-- Restore previous SQL mode
-- 
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;

-- 
-- Enable foreign keys
-- 
/*!40014 SET FOREIGN_KEY_CHECKS = @OLD_FOREIGN_KEY_CHECKS */;